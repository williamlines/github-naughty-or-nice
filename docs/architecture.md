# Architecture Document: Naughty or Nice

> **Technical architecture for the GitHub activity analyzer**  
> _Version 1.2 â€” Generated by BMAD Architect_
>
> **Last Updated:** 2025-12-07  
> **Status:** Validated âœ…

---

## Table of Contents

1. [System Overview](#1-system-overview)
2. [Technology Stack](#2-technology-stack)
3. [API Design](#3-api-design)
4. [Data Models](#4-data-models)
5. [Component Architecture](#5-component-architecture)
6. [Scoring Engine](#6-scoring-engine)
7. [GitHub API Integration](#7-github-api-integration)
8. [AI Integration](#8-ai-integration)
9. [Caching Strategy](#9-caching-strategy)
10. [Error Handling](#10-error-handling)
11. [Environment & Configuration](#11-environment--configuration)
12. [Security Considerations](#12-security-considerations)
13. [Performance Budget](#13-performance-budget)

---

## 1. System Overview

### 1.1 Architecture Pattern

**Monolithic Next.js Application** with:

- Server-side API routes for data fetching and processing
- Client-side React components for UI/UX
- Edge-optimized OG image generation

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        VERCEL EDGE                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚   Next.js   â”‚    â”‚  API Routes â”‚    â”‚  OG Image   â”‚     â”‚
â”‚  â”‚   Frontend  â”‚â—„â”€â”€â–ºâ”‚  (Serverless)â”‚    â”‚  (Edge)     â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                            â”‚                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚                             â”‚
              â–¼                             â–¼
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚  GitHub API  â”‚             â”‚  OpenAI API  â”‚
      â”‚  (REST v3)   â”‚             â”‚  (GPT-4o-mini)â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.2 Request Flow

1. **User submits username** â†’ Client validates input
2. **Client calls `/api/analyze/[username]`** â†’ Server route handles request
3. **Server checks cache** â†’ Return cached result if fresh (<1 hour)
4. **Server fetches GitHub data** â†’ Parallel API calls for efficiency
5. **Scoring engine processes data** â†’ Calculate 6 category scores
6. **OpenAI generates verdict** â†’ Personalized Santa message
7. **Response cached & returned** â†’ Client renders results
8. **OG image generated on-demand** â†’ For social sharing

---

## 2. Technology Stack

### 2.1 Core Framework

| Layer     | Technology | Version  | Purpose                    |
| --------- | ---------- | -------- | -------------------------- |
| Runtime   | Node.js    | 20.x LTS | Server runtime             |
| Framework | Next.js    | 15.x     | Full-stack React framework |
| Language  | TypeScript | 5.x      | Type safety                |
| React     | React      | 19.x     | UI library                 |

### 2.2 Styling & Animation

| Package        | Version | Purpose                               |
| -------------- | ------- | ------------------------------------- |
| Tailwind CSS   | 3.4.x   | Utility-first styling                 |
| Framer Motion  | 12.x    | Reveal animations, micro-interactions |
| clsx           | 2.x     | Conditional class names               |
| tailwind-merge | 3.x     | Merge Tailwind classes safely         |

### 2.3 External Services

| Service            | Purpose              | Auth Method           |
| ------------------ | -------------------- | --------------------- |
| GitHub REST API v3 | User activity data   | Personal Access Token |
| OpenAI API         | Verdict generation   | API Key               |
| Vercel             | Hosting & deployment | N/A                   |

### 2.4 Development Tools

| Tool       | Purpose              |
| ---------- | -------------------- |
| ESLint     | Code linting         |
| Prettier   | Code formatting      |
| TypeScript | Static type checking |

---

## 3. API Design

### 3.1 Route Overview

| Route                     | Method | Purpose                |
| ------------------------- | ------ | ---------------------- |
| `/api/analyze/[username]` | GET    | Main analysis endpoint |
| `/api/og/[username]`      | GET    | Social share image     |

### 3.2 Analysis Endpoint

**`GET /api/analyze/[username]`**

#### Request

```
GET /api/analyze/octocat
```

#### Success Response (200)

```typescript
{
  "success": true,
  "data": {
    "username": "octocat",
    "avatarUrl": "https://avatars.githubusercontent.com/u/583231",
    "profileUrl": "https://github.com/octocat",
    "analyzedAt": "2025-12-07T12:00:00Z",
    "yearAnalyzed": 2025,
    "hasActivity": true,

    "verdict": {
      "tier": "very-nice",
      "label": "Very Nice",
      "emoji": "ğŸ˜‡",
      "score": 78,
      "flavor": "Definitely on the nice list",
      "aiSummary": "Ah, @octocat, Santa's been watching! Your commits..."
    },

    "categories": {
      "commitConsistency": {
        "score": 82,
        "quip": "Steady as a reindeer",
        "stats": {
          "totalCommits": 234,
          "activeWeeks": 42,
          "longestGap": 14,
          "avgCommitsPerWeek": 5.6
        }
      },
      "messageQuality": {
        "score": 65,
        "quip": "Your commits tell a story... mostly in single words",
        "stats": {
          "avgMessageLength": 28,
          "shortMessagePercent": 32,
          "conventionalPercent": 45
        }
      },
      "prHygiene": {
        "score": 71,
        "quip": "Reviewers appreciate you",
        "stats": {
          "totalPRs": 45,
          "avgLinesChanged": 287,
          "megaPRPercent": 8
        }
      },
      "reviewKarma": {
        "score": 58,
        "quip": "The elves want more reviews",
        "stats": {
          "reviewsGiven": 23,
          "reviewsReceived": 41,
          "karmaRatio": 0.56
        }
      },
      "issueCitizenship": {
        "score": 85,
        "quip": "A tidy workshop indeed",
        "stats": {
          "issuesOpened": 12,
          "issuesClosed": 18,
          "avgCloseTime": 4.2
        }
      },
      "collaborationSpirit": {
        "score": 72,
        "quip": "Spreading holiday cheer",
        "stats": {
          "externalContributions": 8,
          "uniqueReposContributed": 5,
          "ownRepoPercent": 68
        }
      }
    },

    "summary": {
      "totalCommits": 234,
      "totalPRs": 45,
      "totalReviews": 23,
      "totalIssues": 30
    },

    "dataCompleteness": {
      "eventsLimited": false,
      "reposAnalyzed": 10,
      "reposTotal": 45,
      "note": null
    }
  }
}
```

#### Error Responses

**User Not Found (404)**

```json
{
  "success": false,
  "error": {
    "code": "USER_NOT_FOUND",
    "message": "GitHub user 'nonexistent' not found"
  }
}
```

**No Activity (200 with neutral scores)**

```json
{
  "success": true,
  "data": {
    "username": "ghostuser",
    "avatarUrl": "https://avatars.githubusercontent.com/u/...",
    "profileUrl": "https://github.com/ghostuser",
    "analyzedAt": "2025-12-07T12:00:00Z",
    "yearAnalyzed": 2025,
    "hasActivity": false,

    "verdict": {
      "tier": "borderline",
      "label": "Borderline",
      "emoji": "ğŸ˜¬",
      "score": 50,
      "flavor": "The elves are debating",
      "aiSummary": "Santa couldn't find much activity this year..."
    },

    "categories": {
      "commitConsistency": {
        "score": 50,
        "quip": "A mystery to the elves",
        "stats": {}
      },
      "messageQuality": {
        "score": 50,
        "quip": "No messages to judge",
        "stats": {}
      },
      "prHygiene": { "score": 50, "quip": "The PR list is empty", "stats": {} },
      "reviewKarma": {
        "score": 50,
        "quip": "No reviews on record",
        "stats": {}
      },
      "issueCitizenship": {
        "score": 50,
        "quip": "Issue-free zone",
        "stats": {}
      },
      "collaborationSpirit": { "score": 50, "quip": "Flying solo", "stats": {} }
    },

    "summary": {
      "totalCommits": 0,
      "totalPRs": 0,
      "totalReviews": 0,
      "totalIssues": 0
    },

    "dataCompleteness": {
      "eventsLimited": false,
      "reposAnalyzed": 0,
      "reposTotal": 0,
      "note": "No public activity found for 2025"
    }
  }
}
```

> **Note:** The response always returns the full `UserAnalysis` shape for type consistency. Check `hasActivity: false` to detect inactive users.

**Rate Limited (429)**

```json
{
  "success": false,
  "error": {
    "code": "RATE_LIMITED",
    "message": "API rate limit exceeded",
    "retryAfter": 3600
  }
}
```

**Server Error (500)**

```json
{
  "success": false,
  "error": {
    "code": "INTERNAL_ERROR",
    "message": "An unexpected error occurred"
  }
}
```

### 3.3 OG Image Endpoint

**`GET /api/og/[username]`**

Returns a PNG image (1200x630) for social sharing.

Query Parameters:

- `v` (optional): Cache-busting version

Response Headers:

```
Content-Type: image/png
Cache-Control: public, max-age=86400, s-maxage=86400
```

---

## 4. Data Models

### 4.1 Core Types

```typescript
// types/index.ts

// ============ VERDICT SYSTEM ============

export type VerdictTier =
  | 'extremely-nice'
  | 'very-nice'
  | 'sort-of-nice'
  | 'borderline'
  | 'sort-of-naughty'
  | 'very-naughty'
  | 'extremely-naughty';

export interface Verdict {
  tier: VerdictTier;
  label: string;
  emoji: string;
  score: number; // 0-100
  flavor: string; // Tagline
  aiSummary: string; // Generated by OpenAI
}

// ============ SCORING CATEGORIES ============

export type CategoryId =
  | 'commitConsistency'
  | 'messageQuality'
  | 'prHygiene'
  | 'reviewKarma'
  | 'issueCitizenship'
  | 'collaborationSpirit';

export interface CategoryScore {
  score: number; // 0-100
  quip: string; // One-liner based on score
  stats: Record<string, number | string>;
}

export type CategoryScores = Record<CategoryId, CategoryScore>;

// ============ USER ANALYSIS ============

export interface UserAnalysis {
  username: string;
  avatarUrl: string;
  profileUrl: string;
  analyzedAt: string; // ISO 8601
  yearAnalyzed: number;
  hasActivity: boolean; // false if no public activity found

  verdict: Verdict;
  categories: CategoryScores;

  summary: {
    totalCommits: number;
    totalPRs: number;
    totalReviews: number;
    totalIssues: number;
  };

  // Data completeness indicators (GitHub API limitations)
  dataCompleteness: {
    eventsLimited: boolean; // true if Events API hit 90-day/300-event limit
    reposAnalyzed: number; // Number of repos we fetched data from
    reposTotal: number; // Total public repos user has
    note?: string; // Optional message about data limitations
  };
}

// ============ API RESPONSE ============

export interface AnalysisSuccess {
  success: true;
  data: UserAnalysis;
}

export interface AnalysisError {
  success: false;
  error: {
    code: ErrorCode;
    message: string;
    retryAfter?: number;
  };
}

export type AnalysisResponse = AnalysisSuccess | AnalysisError;

export type ErrorCode =
  | 'USER_NOT_FOUND'
  | 'NO_ACTIVITY'
  | 'RATE_LIMITED'
  | 'GITHUB_ERROR'
  | 'OPENAI_ERROR'
  | 'INTERNAL_ERROR';
```

### 4.2 GitHub Data Types

```typescript
// types/github.ts

export interface GitHubUser {
  login: string;
  id: number;
  avatar_url: string;
  html_url: string;
  public_repos: number;
  created_at: string;
}

export interface GitHubEvent {
  id: string;
  type: string;
  created_at: string;
  repo: {
    id: number;
    name: string;
  };
  payload: Record<string, unknown>;
}

export interface GitHubCommit {
  sha: string;
  commit: {
    message: string;
    author: {
      date: string;
    };
  };
  author: {
    login: string;
  } | null;
}

export interface GitHubPullRequest {
  id: number;
  number: number;
  state: 'open' | 'closed';
  created_at: string;
  merged_at: string | null;
  additions: number;
  deletions: number;
  user: {
    login: string;
  };
}

export interface GitHubReview {
  id: number;
  user: {
    login: string;
  };
  state: string;
  submitted_at: string;
}

export interface GitHubIssue {
  id: number;
  number: number;
  state: 'open' | 'closed';
  created_at: string;
  closed_at: string | null;
  user: {
    login: string;
  };
  pull_request?: unknown; // Present if issue is a PR
}

export interface GitHubRepo {
  id: number;
  name: string;
  full_name: string;
  owner: {
    login: string;
  };
  pushed_at: string;
  default_branch: string;
}

export interface GitHubSearchResult<T> {
  total_count: number;
  incomplete_results: boolean;
  items: T[];
}
```

### 4.3 Scoring Engine Types

```typescript
// types/scoring.ts

export interface RawGitHubData {
  user: GitHubUser;
  events: GitHubEvent[];
  commits: GitHubCommit[];
  pullRequests: GitHubPullRequest[];
  reviewCount: number; // Count of PRs reviewed (from Search API)
  issues: GitHubIssue[];
  dataCompleteness: {
    eventsLimited: boolean;
    reposAnalyzed: number;
    reposTotal: number;
  };
}

export interface ScoringContext {
  username: string;
  year: number;
  data: RawGitHubData;
}

export interface CategoryResult {
  score: number;
  stats: Record<string, number | string>;
}
```

---

## 5. Component Architecture

### 5.1 Component Tree

```
app/
â”œâ”€â”€ layout.tsx              # Root layout (fonts, metadata)
â”œâ”€â”€ page.tsx                # Landing page
â”‚   â””â”€â”€ <UsernameForm />
â”‚
â”œâ”€â”€ [username]/
â”‚   â””â”€â”€ page.tsx            # Results page
â”‚       â”œâ”€â”€ <LoadingState />      # During fetch
â”‚       â”œâ”€â”€ <ErrorState />        # On error
â”‚       â””â”€â”€ <ResultsDisplay />    # On success
â”‚           â”œâ”€â”€ <EnvelopeReveal />
â”‚           â”‚   â””â”€â”€ <VerdictCard />
â”‚           â”œâ”€â”€ <ScoreBreakdown />
â”‚           â”‚   â””â”€â”€ <CategoryRow /> (Ã—6)
â”‚           â”œâ”€â”€ <AISummary />
â”‚           â””â”€â”€ <ShareButtons />
â”‚
â””â”€â”€ components/
    â”œâ”€â”€ ui/                 # Generic UI components
    â”‚   â”œâ”€â”€ Button.tsx
    â”‚   â”œâ”€â”€ Input.tsx
    â”‚   â”œâ”€â”€ ProgressBar.tsx
    â”‚   â””â”€â”€ Snowfall.tsx
    â”‚
    â”œâ”€â”€ UsernameForm.tsx
    â”œâ”€â”€ LoadingState.tsx
    â”œâ”€â”€ ErrorState.tsx
    â”œâ”€â”€ ResultsDisplay.tsx
    â”œâ”€â”€ EnvelopeReveal.tsx
    â”œâ”€â”€ VerdictCard.tsx
    â”œâ”€â”€ ScoreBreakdown.tsx
    â”œâ”€â”€ CategoryRow.tsx
    â”œâ”€â”€ AISummary.tsx
    â””â”€â”€ ShareButtons.tsx
```

### 5.2 Component Specifications

#### `UsernameForm`

- **Purpose:** Capture GitHub username, trigger analysis
- **State:** `username`, `isValidating`, `error`
- **Behavior:**
  - Validates username format (alphanumeric, hyphens)
  - Optional: Preview avatar on valid username
  - Navigates to `/[username]` on submit

#### `LoadingState`

- **Purpose:** Show progress during API fetch
- **Props:** None (self-contained)
- **Behavior:**
  - Cycles through festive messages
  - Shows progress indicator
  - Minimum display time: 2 seconds (theatrical delay)

#### `EnvelopeReveal`

- **Purpose:** Dramatic reveal animation
- **Props:** `children`, `onRevealComplete`
- **Animation:**
  - Envelope slides in from bottom
  - Pauses for anticipation (0.5s)
  - Opens with 3D flip effect
  - Card emerges and scales to full size
- **Library:** Framer Motion

#### `ScoreBreakdown`

- **Purpose:** Display all 6 category scores
- **Props:** `categories: CategoryScores`
- **Children:** Maps to `<CategoryRow />` components

#### `CategoryRow`

- **Purpose:** Single category display
- **Props:** `category: CategoryId`, `data: CategoryScore`
- **Display:** Icon, label, progress bar, score, quip

#### `ShareButtons`

- **Purpose:** Social sharing actions
- **Props:** `username: string`, `score: number`
- **Actions:**
  - Share to X/Twitter (pre-filled text + URL)
  - Copy link to clipboard
  - Download share card image

---

## 6. Scoring Engine

### 6.1 Algorithm Overview

Each category produces a score from 0-100. The overall score is the **unweighted average** of all 6 categories.

```typescript
// lib/scoring.ts

export function calculateOverallScore(categories: CategoryScores): number {
  const scores = Object.values(categories).map((c) => c.score);
  const sum = scores.reduce((a, b) => a + b, 0);
  return Math.round(sum / scores.length);
}

export function getVerdictTier(score: number): VerdictTier {
  if (score >= 90) return 'extremely-nice';
  if (score >= 75) return 'very-nice';
  if (score >= 60) return 'sort-of-nice';
  if (score >= 45) return 'borderline';
  if (score >= 30) return 'sort-of-naughty';
  if (score >= 15) return 'very-naughty';
  return 'extremely-naughty';
}
```

### 6.2 Category Algorithms

#### 1. Commit Consistency (ğŸ“…)

**Goal:** Reward steady contributions over sporadic bursts

```typescript
function scoreCommitConsistency(
  commits: GitHubCommit[],
  year: number
): CategoryResult {
  // Group commits by week number
  const weekMap = new Map<number, number>();
  const totalWeeks = getCurrentWeekOfYear();

  commits.forEach((commit) => {
    const week = getWeekNumber(commit.commit.author.date);
    weekMap.set(week, (weekMap.get(week) || 0) + 1);
  });

  const activeWeeks = weekMap.size;
  const coverageRatio = activeWeeks / totalWeeks;

  // Calculate consistency (penalize high variance)
  const counts = Array.from(weekMap.values());
  const variance = calculateVariance(counts);
  const normalizedVariance = Math.min(variance / 100, 1);

  // Score: 70% coverage + 30% consistency
  const score = Math.round(coverageRatio * 70 + (1 - normalizedVariance) * 30);

  return {
    score: clamp(score, 0, 100),
    stats: {
      totalCommits: commits.length,
      activeWeeks,
      longestGap: calculateLongestGap(weekMap, totalWeeks),
      avgCommitsPerWeek: round(commits.length / activeWeeks, 1),
    },
  };
}
```

#### 2. Message Quality (ğŸ“)

**Goal:** Reward descriptive, meaningful commit messages

```typescript
function scoreMessageQuality(commits: GitHubCommit[]): CategoryResult {
  const messages = commits.map((c) => c.commit.message.split('\n')[0]); // First line only

  const avgLength = average(messages.map((m) => m.length));
  const shortMessages = messages.filter((m) => m.length < 10).length;
  const shortPercent = (shortMessages / messages.length) * 100;

  // Detect low-effort patterns
  const lowEffortPatterns = /^(fix|wip|update|test|asdf|xxx|\.+)$/i;
  const lowEffortCount = messages.filter((m) =>
    lowEffortPatterns.test(m.trim())
  ).length;
  const lowEffortPercent = (lowEffortCount / messages.length) * 100;

  // Detect conventional commits (feat:, fix:, docs:, etc.)
  const conventionalPattern =
    /^(feat|fix|docs|style|refactor|test|chore)(\(.+\))?:/i;
  const conventionalCount = messages.filter((m) =>
    conventionalPattern.test(m)
  ).length;
  const conventionalPercent = (conventionalCount / messages.length) * 100;

  // Scoring formula
  let score = 50; // Baseline

  // Length scoring (up to +25)
  if (avgLength >= 50) score += 25;
  else if (avgLength >= 30) score += 15;
  else if (avgLength >= 20) score += 5;
  else score -= 10;

  // Short message penalty (up to -25)
  score -= Math.min(shortPercent / 2, 25);

  // Low-effort penalty (up to -20)
  score -= Math.min(lowEffortPercent, 20);

  // Conventional commits bonus (up to +20)
  score += Math.min(conventionalPercent / 5, 20);

  return {
    score: clamp(Math.round(score), 0, 100),
    stats: {
      avgMessageLength: Math.round(avgLength),
      shortMessagePercent: Math.round(shortPercent),
      conventionalPercent: Math.round(conventionalPercent),
    },
  };
}
```

#### 3. PR Hygiene (âœ‚ï¸)

**Goal:** Reward reasonably-sized, reviewable PRs

```typescript
function scorePRHygiene(prs: GitHubPullRequest[]): CategoryResult {
  if (prs.length === 0) {
    return {
      score: 50,
      stats: { totalPRs: 0, avgLinesChanged: 0, megaPRPercent: 0 },
    };
  }

  const linesChanged = prs.map((pr) => pr.additions + pr.deletions);
  const avgLines = average(linesChanged);

  const megaPRs = linesChanged.filter((l) => l > 1000).length;
  const megaPRPercent = (megaPRs / prs.length) * 100;

  const smallPRs = linesChanged.filter((l) => l < 400).length;
  const smallPRPercent = (smallPRs / prs.length) * 100;

  // Scoring
  let score = 50;

  // Average size scoring
  if (avgLines < 200) score += 30;
  else if (avgLines < 400) score += 20;
  else if (avgLines < 600) score += 10;
  else if (avgLines > 800) score -= 20;

  // Small PR bonus
  score += Math.min(smallPRPercent / 5, 15);

  // Mega PR penalty
  score -= megaPRPercent;

  return {
    score: clamp(Math.round(score), 0, 100),
    stats: {
      totalPRs: prs.length,
      avgLinesChanged: Math.round(avgLines),
      megaPRPercent: Math.round(megaPRPercent),
    },
  };
}
```

#### 4. Review Karma (ğŸ¤)

**Goal:** Reward participation in reviewing others' code

```typescript
function scoreReviewKarma(
  reviewCount: number, // From Search API total_count
  prs: GitHubPullRequest[],
  username: string
): CategoryResult {
  // Reviews given (count from Search API)
  const reviewsGiven = reviewCount;

  // PRs authored (proxy for reviews received)
  const prsAuthored = prs.filter((pr) => pr.user.login === username).length;

  if (prsAuthored === 0 && reviewsGiven === 0) {
    return {
      score: 50,
      stats: { reviewsGiven: 0, prsAuthored: 0, karmaRatio: 0 },
    };
  }

  // Karma ratio: reviews given / PRs authored
  const karmaRatio =
    prsAuthored > 0 ? reviewsGiven / prsAuthored : reviewsGiven;

  // Scoring
  let score = 30; // Baseline

  // Reviews given bonus (up to +40)
  score += Math.min(reviewsGiven * 4, 40);

  // Karma ratio bonus (up to +30)
  if (karmaRatio >= 1.0) score += 30;
  else if (karmaRatio >= 0.5) score += 20;
  else if (karmaRatio >= 0.25) score += 10;

  return {
    score: clamp(Math.round(score), 0, 100),
    stats: {
      reviewsGiven,
      prsAuthored,
      karmaRatio: round(karmaRatio, 2),
    },
  };
}
```

#### 5. Issue Citizenship (ğŸ§¹)

**Goal:** Reward engagement with issues beyond just opening them

```typescript
function scoreIssueCitizenship(
  issues: GitHubIssue[],
  username: string
): CategoryResult {
  // Filter out PRs (they appear in issues API)
  const realIssues = issues.filter((i) => !i.pull_request);

  const opened = realIssues.filter((i) => i.user.login === username);
  const closed = realIssues.filter(
    (i) => i.state === 'closed' && i.user.login === username
  );

  if (opened.length === 0) {
    return {
      score: 50,
      stats: { issuesOpened: 0, issuesClosed: 0, closeRatio: 0 },
    };
  }

  const closeRatio = closed.length / opened.length;

  // Calculate average close time (days)
  const closeTimes = closed
    .filter((i) => i.closed_at)
    .map((i) => {
      const opened = new Date(i.created_at);
      const closed = new Date(i.closed_at!);
      return (closed.getTime() - opened.getTime()) / (1000 * 60 * 60 * 24);
    });
  const avgCloseTime = closeTimes.length > 0 ? average(closeTimes) : 0;

  // Scoring
  let score = 40;

  // Close ratio bonus (up to +40)
  score += closeRatio * 40;

  // Fast close bonus (up to +20)
  if (avgCloseTime > 0) {
    if (avgCloseTime < 7) score += 20;
    else if (avgCloseTime < 14) score += 15;
    else if (avgCloseTime < 30) score += 10;
  }

  return {
    score: clamp(Math.round(score), 0, 100),
    stats: {
      issuesOpened: opened.length,
      issuesClosed: closed.length,
      avgCloseTime: round(avgCloseTime, 1),
    },
  };
}
```

#### 6. Collaboration Spirit (ğŸŒ)

**Goal:** Reward contributions beyond personal repos

```typescript
function scoreCollaborationSpirit(
  events: GitHubEvent[],
  username: string
): CategoryResult {
  // Identify contribution events to external repos
  const contributionTypes = ['PushEvent', 'PullRequestEvent', 'IssuesEvent'];
  const contributions = events.filter((e) =>
    contributionTypes.includes(e.type)
  );

  // Separate own vs external repos (heuristic: repo name starts with username)
  const ownRepoPattern = new RegExp(`^${username}/`, 'i');
  const external = contributions.filter(
    (e) => !ownRepoPattern.test(e.repo.name)
  );
  const internal = contributions.filter((e) =>
    ownRepoPattern.test(e.repo.name)
  );

  const totalContributions = contributions.length;
  const externalPercent =
    totalContributions > 0 ? (external.length / totalContributions) * 100 : 0;

  // Unique external repos
  const uniqueExternalRepos = new Set(external.map((e) => e.repo.name)).size;

  // Scoring
  let score = 30;

  // External contribution bonus (up to +40)
  score += Math.min(externalPercent / 2.5, 40);

  // Diversity bonus (up to +30)
  score += Math.min(uniqueExternalRepos * 6, 30);

  return {
    score: clamp(Math.round(score), 0, 100),
    stats: {
      externalContributions: external.length,
      uniqueReposContributed: uniqueExternalRepos,
      ownRepoPercent: Math.round(100 - externalPercent),
    },
  };
}
```

### 6.3 Quip Generation

```typescript
// lib/quips.ts

export const quips: Record<CategoryId, Record<string, string>> = {
  commitConsistency: {
    high: 'Steady as a reindeer',
    medium: 'Mostly consistent, with some hibernation',
    low: 'Feast or famine commits',
  },
  messageQuality: {
    high: 'Your commits tell a beautiful story',
    medium: 'Your commits tell a story... mostly in single words',
    low: "The elves can't read your commit history",
  },
  prHygiene: {
    high: 'Reviewers love your bite-sized PRs',
    medium: 'Reviewers appreciate you',
    low: 'Your PRs need a table of contents',
  },
  reviewKarma: {
    high: 'A true code review champion',
    medium: 'The elves want more reviews',
    low: 'The review queue misses you',
  },
  issueCitizenship: {
    high: 'A tidy workshop indeed',
    medium: 'Some open issues gathering dust',
    low: 'Your issues are having a party without you',
  },
  collaborationSpirit: {
    high: 'Open source hero status',
    medium: 'Spreading holiday cheer',
    low: 'Your code rarely leaves home',
  },
};

export function getQuip(category: CategoryId, score: number): string {
  const tier = score >= 70 ? 'high' : score >= 40 ? 'medium' : 'low';
  return quips[category][tier];
}
```

---

## 7. GitHub API Integration

### 7.1 API Client

```typescript
// lib/github.ts

const GITHUB_API_BASE = 'https://api.github.com';

class GitHubClient {
  private token: string;

  constructor(token: string) {
    this.token = token;
  }

  private async fetch<T>(endpoint: string, options?: RequestInit): Promise<T> {
    const response = await fetch(`${GITHUB_API_BASE}${endpoint}`, {
      ...options,
      headers: {
        Authorization: `Bearer ${this.token}`,
        Accept: 'application/vnd.github.v3+json',
        'X-GitHub-Api-Version': '2022-11-28',
        ...options?.headers,
      },
    });

    if (!response.ok) {
      if (response.status === 404) {
        throw new GitHubError('USER_NOT_FOUND', 'User not found');
      }
      if (response.status === 403) {
        const resetTime = response.headers.get('X-RateLimit-Reset');
        throw new GitHubError('RATE_LIMITED', 'Rate limit exceeded', {
          retryAfter: resetTime
            ? parseInt(resetTime) - Date.now() / 1000
            : 3600,
        });
      }
      throw new GitHubError(
        'GITHUB_ERROR',
        `GitHub API error: ${response.status}`
      );
    }

    return response.json();
  }

  async getUser(username: string): Promise<GitHubUser> {
    return this.fetch(`/users/${username}`);
  }

  async getEvents(username: string, page = 1): Promise<GitHubEvent[]> {
    // Note: Events API only returns last 90 days, max 300 events
    return this.fetch(`/users/${username}/events?per_page=100&page=${page}`);
  }

  async getRepos(username: string): Promise<GitHubRepo[]> {
    return this.fetch(`/users/${username}/repos?per_page=100&sort=updated`);
  }

  async getRepoCommits(
    owner: string,
    repo: string,
    author: string,
    since: string
  ): Promise<GitHubCommit[]> {
    return this.fetch(
      `/repos/${owner}/${repo}/commits?author=${author}&since=${since}&per_page=100`
    );
  }

  async getPullRequests(
    owner: string,
    repo: string,
    author: string
  ): Promise<GitHubPullRequest[]> {
    return this.fetch(
      `/repos/${owner}/${repo}/pulls?state=all&per_page=100`
    ).then((prs) => prs.filter((pr) => pr.user.login === author));
  }

  async getReviewCount(username: string, since: string): Promise<number> {
    // Use Search API to count PRs reviewed by user
    // Note: Search API has stricter rate limits (30 req/min)
    const result = await this.fetch<GitHubSearchResult<unknown>>(
      `/search/issues?q=reviewed-by:${username}+type:pr+created:>=${since}`
    );
    return result.total_count;
  }

  async getIssues(username: string, since: string): Promise<GitHubIssue[]> {
    return this.fetch(
      `/search/issues?q=author:${username}+created:>=${since}&per_page=100`
    );
  }
}
```

### 7.2 Data Fetching Strategy

```typescript
// lib/github.ts

export async function fetchUserData(
  username: string,
  year: number = new Date().getFullYear()
): Promise<RawGitHubData> {
  const client = new GitHubClient(process.env.GITHUB_TOKEN!);
  const since = `${year}-01-01T00:00:00Z`;

  // Fetch user first (validates existence)
  const user = await client.getUser(username);

  // Parallel fetch for efficiency
  const [events, repos] = await Promise.all([
    client.getEvents(username),
    client.getRepos(username),
  ]);

  // Filter repos to current year activity
  const activeRepos = repos
    .filter((r) => new Date(r.pushed_at) >= new Date(since))
    .slice(0, 10); // Limit to top 10 most recent

  // Fetch commits, PRs from active repos (parallel)
  const repoData = await Promise.all(
    activeRepos.map(async (repo) => {
      const [commits, prs] = await Promise.all([
        client.getRepoCommits(repo.owner.login, repo.name, username, since),
        client.getPullRequests(repo.owner.login, repo.name, username),
      ]);
      return { commits, prs };
    })
  );

  // Flatten results
  const commits = repoData.flatMap((r) => r.commits);
  const pullRequests = repoData.flatMap((r) => r.prs);

  // Fetch issues and review count
  const [issueResults, reviewCount] = await Promise.all([
    client.getIssues(username, since.split('T')[0]),
    client.getReviewCount(username, since.split('T')[0]),
  ]);

  // Check data completeness
  const eventsLimited = events.length >= 300; // GitHub caps at 300

  return {
    user,
    events,
    commits,
    pullRequests,
    reviewCount, // Changed from reviews array to count
    issues: issueResults.items || [],
    dataCompleteness: {
      eventsLimited,
      reposAnalyzed: activeRepos.length,
      reposTotal: repos.length,
    },
  };
}
```

### 7.3 Rate Limit Management

#### Core API Limits

- **Token:** Personal Access Token (5,000 requests/hour)
- **Strategy:** Cache aggressively, batch requests where possible
- **Headers to monitor:**
  - `X-RateLimit-Remaining`
  - `X-RateLimit-Reset`

#### Search API Limits (Stricter!)

- **Limit:** 30 requests/minute (authenticated)
- **Used by:** `getIssues()`, `getReviewCount()`
- **Strategy:** Minimize search calls, cache results aggressively

```typescript
// Monitor search rate limits separately
const searchHeaders = {
  'X-RateLimit-Limit': '30',
  'X-RateLimit-Remaining': '...',
  'X-RateLimit-Reset': '...',
};
```

### 7.4 GitHub API Limitations

| Limitation                 | Impact                           | Mitigation                            |
| -------------------------- | -------------------------------- | ------------------------------------- |
| Events API: 90 days max    | Can't see Jan-Sep activity       | Show `dataCompleteness` warning       |
| Events API: 300 events max | Heavy users lose data            | Rely on commits/PR APIs for full data |
| Search API: 30 req/min     | Can hit limit with traffic       | Cache aggressively, queue requests    |
| Commits: 100 per page      | Need pagination for active repos | Limit to top 10 active repos          |

---

## 8. AI Integration

### 8.1 OpenAI Client

```typescript
// lib/ai.ts

import OpenAI from 'openai';

const openai = new OpenAI({
  apiKey: process.env.OPENAI_API_KEY,
});

export interface VerdictInput {
  username: string;
  overallScore: number;
  verdictTier: VerdictTier;
  categories: CategoryScores;
  summary: {
    totalCommits: number;
    totalPRs: number;
    totalReviews: number;
    totalIssues: number;
  };
}

export async function generateAIVerdict(input: VerdictInput): Promise<string> {
  const systemPrompt = `You are Santa Claus reviewing a developer's GitHub activity for the year. 
Write a 2-3 sentence personalized, festive verdict. Be warm but honest.
Reference specific metrics when relevant (commits, PRs, reviews).
Keep it fun, playful, and shareable.
Do NOT use generic platitudes - make it specific to their data.
End with a forward-looking comment about next year.`;

  const userPrompt = `Developer: @${input.username}
Overall Score: ${input.overallScore}/100 (${input.verdictTier})

Category Breakdown:
- Commit Consistency: ${input.categories.commitConsistency.score}/100
- Message Quality: ${input.categories.messageQuality.score}/100  
- PR Hygiene: ${input.categories.prHygiene.score}/100
- Review Karma: ${input.categories.reviewKarma.score}/100
- Issue Citizenship: ${input.categories.issueCitizenship.score}/100
- Collaboration Spirit: ${input.categories.collaborationSpirit.score}/100

Stats:
- Total Commits: ${input.summary.totalCommits}
- Total PRs: ${input.summary.totalPRs}
- Total Reviews: ${input.summary.totalReviews}
- Total Issues: ${input.summary.totalIssues}`;

  try {
    const response = await openai.chat.completions.create({
      model: 'gpt-4o-mini',
      messages: [
        { role: 'system', content: systemPrompt },
        { role: 'user', content: userPrompt },
      ],
      max_tokens: 200,
      temperature: 0.8, // Slightly creative
    });

    return response.choices[0]?.message?.content || getFallbackVerdict(input);
  } catch (error) {
    console.error('OpenAI error:', error);
    return getFallbackVerdict(input);
  }
}

function getFallbackVerdict(input: VerdictInput): string {
  // Template fallback if OpenAI fails
  const templates: Record<VerdictTier, string> = {
    'extremely-nice': `Ho ho ho! @${input.username}, you've been absolutely wonderful this year!`,
    'very-nice': `@${input.username}, Santa is impressed with your ${input.summary.totalCommits} commits!`,
    'sort-of-nice': `@${input.username}, you're on the nice list... but there's room for improvement!`,
    borderline: `@${input.username}, the elves are still debating your case...`,
    'sort-of-naughty': `@${input.username}, coal is looking likely, but there's still hope for next year!`,
    'very-naughty': `@${input.username}, Santa is disappointed, but believes in second chances.`,
    'extremely-naughty': `@${input.username}... we need to talk about those commit messages.`,
  };
  return templates[input.verdictTier];
}
```

---

## 9. Caching Strategy

### 9.1 Cache Implementation

> **âš ï¸ Serverless Limitation:** In-memory cache does not persist across serverless
> function cold starts on Vercel. Cache hits only occur within warm function instances.
> For production, consider upgrading to Vercel KV (Redis) for persistent caching.

```typescript
// lib/cache.ts

// TODO: For production, migrate to Vercel KV for persistent caching
// See: https://vercel.com/docs/storage/vercel-kv
// Current in-memory cache only persists within warm function instances

interface CacheEntry<T> {
  data: T;
  timestamp: number;
  ttl: number;
}

class MemoryCache {
  private store = new Map<string, CacheEntry<unknown>>();

  set<T>(key: string, data: T, ttlSeconds: number = 3600): void {
    this.store.set(key, {
      data,
      timestamp: Date.now(),
      ttl: ttlSeconds * 1000,
    });
  }

  get<T>(key: string): T | null {
    const entry = this.store.get(key) as CacheEntry<T> | undefined;

    if (!entry) return null;

    if (Date.now() - entry.timestamp > entry.ttl) {
      this.store.delete(key);
      return null;
    }

    return entry.data;
  }

  invalidate(key: string): void {
    this.store.delete(key);
  }

  clear(): void {
    this.store.clear();
  }
}

export const cache = new MemoryCache();

// Cache keys
export const cacheKeys = {
  analysis: (username: string) => `analysis:${username.toLowerCase()}`,
};
```

### 9.2 Cache Settings

| Data Type     | TTL      | Rationale                        |
| ------------- | -------- | -------------------------------- |
| User analysis | 1 hour   | Balance freshness vs. API limits |
| OG images     | 24 hours | Rarely changes, CDN cached       |

### 9.3 Cache Invalidation

- **Time-based:** Automatic expiry after TTL
- **On-demand:** No manual invalidation needed for MVP
- **Future:** Add cache-busting param for forced refresh

---

## 10. Error Handling

### 10.1 Error Classes

```typescript
// lib/errors.ts

export class AppError extends Error {
  constructor(
    public code: ErrorCode,
    message: string,
    public statusCode: number = 500,
    public meta?: Record<string, unknown>
  ) {
    super(message);
    this.name = 'AppError';
  }
}

export class GitHubError extends AppError {
  constructor(
    code: ErrorCode,
    message: string,
    meta?: Record<string, unknown>
  ) {
    const statusCodes: Record<string, number> = {
      USER_NOT_FOUND: 404,
      RATE_LIMITED: 429,
      GITHUB_ERROR: 502,
    };
    super(code, message, statusCodes[code] || 500, meta);
    this.name = 'GitHubError';
  }
}

export class OpenAIError extends AppError {
  constructor(message: string) {
    super('OPENAI_ERROR', message, 502);
    this.name = 'OpenAIError';
  }
}
```

### 10.2 Error Handling in API Routes

```typescript
// app/api/analyze/[username]/route.ts

import { NextResponse } from 'next/server';
import { AppError } from '@/lib/errors';

// Next.js 15: params is now a Promise
export async function GET(
  request: Request,
  { params }: { params: Promise<{ username: string }> }
) {
  const { username } = await params;
  
  try {
    const result = await analyzeUser(username);
    return NextResponse.json({ success: true, data: result });
  } catch (error) {
    if (error instanceof AppError) {
      return NextResponse.json(
        {
          success: false,
          error: {
            code: error.code,
            message: error.message,
            ...error.meta,
          },
        },
        { status: error.statusCode }
      );
    }

    console.error('Unexpected error:', error);
    return NextResponse.json(
      {
        success: false,
        error: {
          code: 'INTERNAL_ERROR',
          message: 'An unexpected error occurred',
        },
      },
      { status: 500 }
    );
  }
}
```

### 10.3 Client-Side Error Handling

```typescript
// hooks/useAnalysis.ts

export function useAnalysis(username: string) {
  const [state, setState] = useState<{
    status: 'idle' | 'loading' | 'success' | 'error';
    data: UserAnalysis | null;
    error: AnalysisError | null;
  }>({
    status: 'idle',
    data: null,
    error: null,
  });

  const analyze = async () => {
    setState({ status: 'loading', data: null, error: null });

    try {
      const response = await fetch(`/api/analyze/${username}`);
      const result: AnalysisResponse = await response.json();

      if (result.success) {
        setState({ status: 'success', data: result.data, error: null });
      } else {
        setState({ status: 'error', data: null, error: result.error });
      }
    } catch (error) {
      setState({
        status: 'error',
        data: null,
        error: { code: 'INTERNAL_ERROR', message: 'Network error' },
      });
    }
  };

  return { ...state, analyze };
}
```

---

## 11. Environment & Configuration

### 11.1 Environment Variables

```bash
# .env.local (DO NOT COMMIT)

# GitHub API
GITHUB_TOKEN=ghp_xxxxxxxxxxxxxxxxxxxx

# OpenAI API
OPENAI_API_KEY=sk-xxxxxxxxxxxxxxxxxxxx

# App Config
NEXT_PUBLIC_APP_URL=http://localhost:3000
```

### 11.2 Environment Validation

```typescript
// lib/env.ts

const requiredEnvVars = ['GITHUB_TOKEN', 'OPENAI_API_KEY'] as const;

export function validateEnv() {
  const missing = requiredEnvVars.filter((key) => !process.env[key]);

  if (missing.length > 0) {
    throw new Error(
      `Missing required environment variables: ${missing.join(', ')}`
    );
  }
}

export const env = {
  githubToken: process.env.GITHUB_TOKEN!,
  openaiApiKey: process.env.OPENAI_API_KEY!,
  appUrl: process.env.NEXT_PUBLIC_APP_URL || 'http://localhost:3000',
};
```

---

## 12. Security Considerations

### 12.1 API Security

| Concern          | Mitigation                                      |
| ---------------- | ----------------------------------------------- |
| Token exposure   | Server-only, never in client bundle             |
| Input validation | Sanitize username (alphanumeric + hyphens only) |
| Rate limiting    | Inherit from Vercel + GitHub limits             |
| XSS              | React's default escaping, sanitize AI output    |

### 12.2 Username Validation

```typescript
// lib/validation.ts

const USERNAME_REGEX = /^[a-zA-Z0-9](?:[a-zA-Z0-9-]*[a-zA-Z0-9])?$/;
const MAX_USERNAME_LENGTH = 39;

export function validateUsername(username: string): {
  valid: boolean;
  error?: string;
} {
  if (!username || username.length === 0) {
    return { valid: false, error: 'Username is required' };
  }

  if (username.length > MAX_USERNAME_LENGTH) {
    return { valid: false, error: 'Username is too long' };
  }

  if (!USERNAME_REGEX.test(username)) {
    return {
      valid: false,
      error: 'Username can only contain letters, numbers, and hyphens',
    };
  }

  return { valid: true };
}
```

---

## 13. Performance Budget

### 13.1 Target Metrics

| Metric                | Target         | Measurement   |
| --------------------- | -------------- | ------------- |
| Time to Interactive   | <2s            | Lighthouse    |
| API Response (cached) | <100ms         | Server logs   |
| API Response (fresh)  | <5s            | Server logs   |
| OG Image Generation   | <1s            | Edge function |
| Bundle Size (JS)      | <150KB gzipped | Build output  |

### 13.2 Optimization Strategies

1. **Parallel GitHub API calls** â€” Fetch commits, PRs, issues simultaneously
2. **Aggressive caching** â€” 1-hour TTL for analysis results
3. **Client-side navigation** â€” Next.js App Router prefetching
4. **Image optimization** â€” Next.js Image component for avatars
5. **Code splitting** â€” Dynamic imports for Framer Motion animations
6. **Edge deployment** â€” Vercel edge network for low latency

---

## Appendix: Verdict Tiers Reference

| Tier                | Score Range | Label             | Emoji | Flavor                            |
| ------------------- | ----------- | ----------------- | ----- | --------------------------------- |
| `extremely-nice`    | 90-100      | Extremely Nice    | ğŸ…    | Santa's putting you on speed dial |
| `very-nice`         | 75-89       | Very Nice         | ğŸ˜‡    | Definitely on the nice list       |
| `sort-of-nice`      | 60-74       | Sort of Nice      | ğŸ™‚    | Nice-ish... we'll allow it        |
| `borderline`        | 45-59       | Borderline        | ğŸ˜¬    | The elves are debating            |
| `sort-of-naughty`   | 30-44       | Sort of Naughty   | ğŸ˜ˆ    | Coal is looking likely            |
| `very-naughty`      | 15-29       | Very Naughty      | ğŸ‘¿    | Santa's disappointed              |
| `extremely-naughty` | 0-14        | Extremely Naughty | ğŸ’€    | Krampus has entered the chat      |

---

## Changelog

### Version 1.2 (2025-12-07) â€” Next.js 15 Upgrade

Framework upgrades:

1. **Upgraded Next.js 14.x â†’ 15.x** â€” Leveraging Turbopack, improved performance
2. **Upgraded React 18.x â†’ 19.x** â€” New hooks (`useActionState`, `useOptimistic`)
3. **Upgraded Framer Motion 11.x â†’ 12.x** â€” Latest animation features
4. **Upgraded tailwind-merge 2.x â†’ 3.x** â€” Latest merge utilities
5. **Async params pattern** â€” Route handlers now use `params: Promise<{...}>` pattern

### Version 1.1 (2025-12-07) â€” Post-Validation Update

Changes made following architecture validation:

1. **Added `GitHubRepo` type** â€” Was referenced but not defined
2. **Added `GitHubSearchResult<T>` type** â€” For Search API responses
3. **Added `dataCompleteness` field** â€” Tracks GitHub API data limitations
4. **Added `hasActivity` field** â€” Distinguishes active vs. inactive users
5. **Normalized "No Activity" response** â€” Now returns full `UserAnalysis` shape with neutral scores
6. **Simplified reviews to count-based** â€” Uses Search API `total_count` instead of fetching all review objects
7. **Added cache limitation warning** â€” Documents serverless in-memory cache constraints
8. **Added GitHub API limitations table** â€” Documents Events API 90-day limit, Search API rate limits
9. **Updated `RawGitHubData` type** â€” Now includes `reviewCount` and `dataCompleteness`

### Version 1.0 (2025-12-07) â€” Initial Architecture

- Complete technical architecture for MVP
- All 6 scoring categories with algorithms
- API design with TypeScript types
- GitHub API integration strategy
- OpenAI verdict generation
- Component architecture
- Error handling patterns

---

_Architecture document generated by BMAD Architect Agent â€” Ready for implementation_
